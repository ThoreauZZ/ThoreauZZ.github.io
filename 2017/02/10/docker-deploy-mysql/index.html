<!DOCTYPE html>
<html lang="zh_CN">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    
    
        <meta name="twitter:card" content="summary"/>
    



<meta name="twitter:title" content="Docker部署MySql等常用软件"/>
<meta name="twitter:description" content=""/>
<meta name="twitter:site" content="@zhaozhou2010"/>



  	<meta property="og:title" content="Docker部署MySql等常用软件 &middot; 造舟野渡" />
  	<meta property="og:site_name" content="造舟野渡" />
  	<meta property="og:url" content="http://thoreauz.com/2017/02/10/docker-deploy-mysql/" />
    <meta name="generator" content="Hugo 0.99.1" />
    
        
            <meta property="og:image" content="/images/cover.jpg"/>
        
    

    
    <meta property="og:description" content="" />
  	<meta property="og:type" content="article" />
    <meta property="article:published_time" content="2017-02-10T15:20:04Z" />

    
    <meta property="article:tag" content="docker" />
    
    <meta property="article:tag" content="mysql" />
    
    

    <title>Docker部署MySql等常用软件 &middot; 造舟野渡</title>

    
    <meta name="description" content="Docker部署MySql等常用软件 一、MySql 1.1 获取镜像运行 选定mysql版本，直接用以下命令获取mysql镜像并启动 docker run --name mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD=1234 -d" />
    

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="http://thoreauz.com/images/favicon.ico">
	  <link rel="apple-touch-icon" href="http://thoreauz.com/images/apple-touch-icon.png" />

    <link rel="stylesheet" type="text/css" href="http://thoreauz.com/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="http://thoreauz.com/css/nav.css" />

    

    
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/atelier-forest-light.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
        
          
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/go.min.js"></script>
          
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/lua.min.js"></script>
          
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/vim.min.js"></script>
          
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/yaml.min.js"></script>
          
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/dockerfile.min.js"></script>
          
        
        <script>hljs.initHighlightingOnLoad();</script>
    

    
      
          <link href="http://thoreauz.com/index.xml" rel="alternate" type="application/rss+xml" title="造舟野渡" />
      
      
    
    
    <meta name="generator" content="Hugo 0.105.0">

    <link rel="canonical" href="http://thoreauz.com/2017/02/10/docker-deploy-mysql/" />

    
      
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name":  null ,
        "logo": "http://thoreauz.comDog-b.svg"
    },
    "author": {
        "@type": "Person",
        "name":  null ,
        
        "image": {
            "@type": "ImageObject",
            "url": "http://thoreauz.comDog-b.svg",
            "width": 250,
            "height": 250
        }, 
        
        "url": "http://thoreauz.com",
        "sameAs": [
            
            
             
             
             
             
             
            
        ]
    },
    "headline": "Docker部署MySql等常用软件",
    "name": "Docker部署MySql等常用软件",
    "wordCount":  1281 ,
    "timeRequired": "PT3M",
    "inLanguage": {
      "@type": "Language",
      "alternateName": "en"
    },
    "url": "http://thoreauz.com/2017/02/10/docker-deploy-mysql/",
    "datePublished": "2017-02-10T15:20Z",
    "dateModified": "2017-02-10T15:20Z",
    
    "keywords": "docker, mysql",
    "description": "",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://thoreauz.com/2017/02/10/docker-deploy-mysql/"
    }
}
    </script>
    


    

    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-113511621-1', 'auto');
      ga('send', 'pageview');

    </script>
    

    
    
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
        </script>
    

    
</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
        
            
            <li class="nav-opened" role="presentation">
            	<a href="http://thoreauz.com/archives/">归档</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="http://thoreauz.com/tags/">标签</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="http://thoreauz.com/about/">关于</a>
            </li>
        
        
    </ul>

    
    <a class="subscribe-button icon-feed" href='http://thoreauz.com/index.xml'>Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">



  <header class="main-header post-head no-cover">
  <nav class="main-nav clearfix">


  
       <a class="blog-logo" href="http://thoreauz.com"><img src="http://thoreauz.com/Dog-b.svg" alt="Home" /></a>
      
  

  
      <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
  
  </nav>
</header>


<main class="content" role="main">

  <article class="post post">

    <header class="post-header">
        <h1 class="post-title">Docker部署MySql等常用软件</h1>
        <small></small>

        <section class="post-meta">
        
          <time class="post-date" datetime="2017-02-10T15:20:04Z">
            2017-02-10
          </time>
        
         
          <span class="post-tag small"><a href="http://thoreauz.com/tags/docker/">docker</a></span>
         
          <span class="post-tag small"><a href="http://thoreauz.com/tags/mysql/">mysql</a></span>
         
        </section>
    </header>

    <section class="post-content">
      <h1 id="docker部署mysql等常用软件">Docker部署MySql等常用软件</h1>
<h2 id="一mysql">一、MySql</h2>
<h3 id="11-获取镜像运行">1.1 获取镜像运行</h3>
<p>选定mysql版本，直接用以下命令获取mysql镜像并启动</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker run --name mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD<span style="color:#f92672">=</span><span style="color:#ae81ff">1234</span> -d mysql:5.6.35
</span></span></code></pre></div><p>测试链接：mysql -h ip -uroot -p1234</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mysql&gt; show databases;
</span></span><span style="display:flex;"><span>+--------------------+
</span></span><span style="display:flex;"><span>| Database           |
</span></span><span style="display:flex;"><span>+--------------------+
</span></span><span style="display:flex;"><span>| information_schema |
</span></span><span style="display:flex;"><span>| mysql              |
</span></span><span style="display:flex;"><span>| performance_schema |
</span></span><span style="display:flex;"><span>+--------------------+
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3</span> rows in set <span style="color:#f92672">(</span>0.00 sec<span style="color:#f92672">)</span>
</span></span></code></pre></div><h3 id="12-mysql数据持久化">1.2 mysql数据持久化</h3>
<p>查看docker mysql 默认配置：</p>
<pre tabindex="0"><code>$ docker exec mysql cat /etc/mysql/my.cnf 
</code></pre><p>配置信息如下：</p>
<pre tabindex="0"><code># Copyright (c) 2015, Oracle and/or its affiliates. All rights reserved.
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation; version 2 of the License.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA

#
# The MySQL Community Server configuration file.
#
# For explanations see
# http://dev.mysql.com/doc/mysql/en/server-system-variables.html

[client]
port		= 3306
socket		= /var/run/mysqld/mysqld.sock

[mysqld_safe]
pid-file	= /var/run/mysqld/mysqld.pid
socket		= /var/run/mysqld/mysqld.sock
nice		= 0

[mysqld]
user		= mysql
pid-file	= /var/run/mysqld/mysqld.pid
socket		= /var/run/mysqld/mysqld.sock
port		= 3306
basedir		= /usr
datadir		= /var/lib/mysql
tmpdir		= /tmp
lc-messages-dir	= /usr/share/mysql
explicit_defaults_for_timestamp

# Instead of skip-networking the default is now to listen only on
# localhost which is more compatible and is not less secure.
#bind-address	= 127.0.0.1

#log-error	= /var/log/mysql/error.log

# Recommended in standard MySQL setup
sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES

# Disabling symbolic-links is recommended to prevent assorted security risks
symbolic-links=0

# * IMPORTANT: Additional settings that can override those from this file!
#   The files must end with &#39;.cnf&#39;, otherwise they&#39;ll be ignored.
#
!includedir /etc/mysql/conf.d/
</code></pre><p>从配置可以看出mysql的data默认在docker容器的<code>/var/lib/mysql</code>目录下。如果不希望数据和容器生命周期一样，可以把宿主机某某目录挂载到<code>/var/lib/mysql</code>。于是，启动命令变成了：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker run --name mysql <span style="color:#ae81ff">\ </span>
</span></span><span style="display:flex;"><span>    -p 3306:3306 <span style="color:#ae81ff">\ </span>
</span></span><span style="display:flex;"><span>    -e MYSQL_ROOT_PASSWORD<span style="color:#f92672">=</span><span style="color:#ae81ff">1234</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    -v /data/docker/mysql:/var/lib/mysql <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>    -d mysql:5.6.35
</span></span></code></pre></div><p>可以在宿主机编写自己的mysql配置文件如：<code>/my/custom/config-file.cnf</code>，启动命令就变成了：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker run --name mysql <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -p 3306:3306 <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -v /data/docker/mysql:/var/lib/mysql <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -v /my/custom:/etc/mysql/conf.d <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -e MYSQL_ROOT_PASSWORD<span style="color:#f92672">=</span><span style="color:#ae81ff">1234</span> <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -d mysql:5.5
</span></span></code></pre></div><h2 id="rabbitmq">RabbitMQ</h2>
<p>rabbit的启动很简单，如果用<code>docker-compose</code>编排，mysql和rabiit放在一起如下</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#f92672">version</span>: <span style="color:#e6db74">&#39;2&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">services</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">mysql</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">mysql:5.6.35</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#e6db74">&#34;3306:3306&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">volumes</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">/data/docker/mysql:/var/lib/mysql</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">environment</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">MYSQL_ROOT_PASSWORD</span>: <span style="color:#ae81ff">IWEkzXvG5940</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">rabbitmq</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">image</span>: <span style="color:#ae81ff">10.69.42.85</span>:<span style="color:#ae81ff">5000</span><span style="color:#ae81ff">/mxsev/rabbitmq:management</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">expose</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">5672</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#ae81ff">15672</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">ports</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#e6db74">&#34;5672:5672&#34;</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#e6db74">&#34;15672:15672&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">environment</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">RABBITMQ_DEFAULT_VHOST</span>: <span style="color:#ae81ff">bs-vhost</span>
</span></span></code></pre></div><h2 id="三dockerfile构建redis伪集群">三、Dockerfile构建redis伪集群</h2>
<p>文件结构：
<img src="http://thoreauz.com/images/docker-redis.jpg" alt=""></p>
<h3 id="31-编写dockerfie">3,1 编写Dockerfie</h3>
<pre tabindex="0"><code>FROM centos

MAINTAINER erdaoya

ENV HOME /

# # Ensure UTF-8 lang and locale
#RUN locale-gen en_US.UTF-8
#ENV LANG       en_US.UTF-8
#ENV LC_ALL     en_US.UTF-8


# Install system dependencies
RUN yum install -y gcc make g++ build-essential libc6-dev wget iproute

# Install ruby dependencies so we can bootstrap the cluster via redis-trib.rb
RUN yum -y install ruby ruby-rdoc &amp;&amp; \
    yum -y install rubygems &amp;&amp; \
    gem sources --add https://ruby.taobao.org/ --remove http://rubygems.org/ &amp;&amp; \
    gem sources -l &amp;&amp; \
    gem install redis

RUN wget --no-check-certificate https://bootstrap.pypa.io/ez_setup.py &amp;&amp; \
    python ez_setup.py --insecure &amp;&amp; \
    easy_install pip &amp;&amp; \
    pip install supervisor

# checkout the 3.0.6 tag (Will change to 3.2 tag when it is released as stable)
RUN wget http://download.redis.io/releases/redis-3.2.6.tar.gz
RUN tar xzf redis-3.2.6.tar.gz

# Build redis from source
RUN (cd ./redis-3.2.6 &amp;&amp; make )
RUN mkdir -p /usr/local/redis/bin &amp;&amp; \
    mkdir -p /usr/local/redis/etc &amp;&amp; \
    cd redis-3.2.6/src/ &amp;&amp; \
    mv mkreleasehdr.sh redis-benchmark redis-check-aof redis-check-rdb redis-cli redis-server redis-trib.rb  /usr/local/redis/bin

ADD ./conf/redis.conf /usr/local/redis/etc/redis.conf
# cp redis conf
RUN cd /usr/local/redis/etc/ &amp;&amp; \
    cp redis.conf redis-3.0.0_7001.conf &amp;&amp; \
    cp redis.conf redis-3.0.0_7002.conf &amp;&amp; \
    cp redis.conf redis-3.0.0_7003.conf &amp;&amp; \
    cp redis.conf redis-3.0.0_7004.conf &amp;&amp; \
    cp redis.conf redis-3.0.0_7005.conf &amp;&amp; \
    cp redis.conf redis-3.0.0_7006.conf

# chage redis port, data and so on
RUN cd /usr/local/redis/etc/ &amp;&amp; \
    sed -i s/7000/7001/g redis-3.0.0_7001.conf &amp;&amp; \
    sed -i s/7000/7002/g redis-3.0.0_7002.conf &amp;&amp; \
    sed -i s/7000/7003/g redis-3.0.0_7003.conf &amp;&amp; \
    sed -i s/7000/7004/g redis-3.0.0_7004.conf &amp;&amp; \
    sed -i s/7000/7005/g redis-3.0.0_7005.conf &amp;&amp; \
    sed -i s/7000/7006/g redis-3.0.0_7006.conf

#  redis db dir
RUN mkdir -p /data/redis-3.0.0/7001/db &amp;&amp; \
    mkdir -p /data/redis-3.0.0/7002/db &amp;&amp; \
    mkdir -p /data/redis-3.0.0/7003/db &amp;&amp; \
    mkdir -p /data/redis-3.0.0/7004/db &amp;&amp; \
    mkdir -p /data/redis-3.0.0/7005/db &amp;&amp; \
    mkdir -p /data/redis-3.0.0/7006/db

# Add supervisord configuration
ADD ./conf/supervisord.conf /etc/supervisor/supervisord.conf

# Add startup script
ADD ./conf/start.sh /start.sh
RUN chmod 755 /start.sh

EXPOSE 7001 7002 7003 7004 7005 7006

CMD [&#34;/bin/bash&#34;, &#34;/start.sh&#34;]
</code></pre><h3 id="32-redis配置文件">3.2 redis配置文件</h3>
<p>config/redis.conf</p>
<pre tabindex="0"><code class="language-conf" data-lang="conf">port 7000
daemonize yes
protected-mode no
pidfile &#34;/logs/redis-3.0.0/redis-3.0.0_7000.pid&#34;
tcp-backlog 511
timeout 0
tcp-keepalive 0
loglevel notice
logfile &#34;/logs/redis-3.0.0/redis-3.0.0_7000.log&#34;
databases 16
save 900 1
save 300 10
save 60 10000
stop-writes-on-bgsave-error yes
rdbcompression yes
rdbchecksum yes
dbfilename dump.rdb
dir /data/redis-3.0.0/7000/db
slave-serve-stale-data yes
slave-read-only yes
repl-diskless-sync no
repl-diskless-sync-delay 5
repl-disable-tcp-nodelay no
slave-priority 100
appendonly yes
appendfilename &#34;appendonly.aof&#34;
appendfsync everysec
no-appendfsync-on-rewrite no
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb
aof-load-truncated yes
lua-time-limit 5000
slowlog-log-slower-than 10000
slowlog-max-len 128
latency-monitor-threshold 0
notify-keyspace-events &#34;&#34;
hash-max-ziplist-entries 512
hash-max-ziplist-value 64
list-max-ziplist-entries 512
list-max-ziplist-value 64
set-max-intset-entries 512
zset-max-ziplist-entries 128
zset-max-ziplist-value 64
hll-sparse-max-bytes 3000
activerehashing yes
client-output-buffer-limit normal 0 0 0
client-output-buffer-limit slave 256mb 64mb 60
client-output-buffer-limit pubsub 32mb 8mb 60
hz 10
aof-rewrite-incremental-fsync yes
maxclients 10000
maxmemory 6442450944
cluster-require-full-coverage no

cluster-enabled yes
cluster-config-file nodes_7000.conf   
cluster-node-timeout 5000
</code></pre><h3 id="33-启动脚本">3.3 启动脚本</h3>
<p>config/start.sh</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>mkdir -p /logs/redis-3.0.0/
</span></span><span style="display:flex;"><span>mkdir -p /var/log/supervisor
</span></span><span style="display:flex;"><span>supervisord -c /etc/supervisor/supervisord.conf
</span></span><span style="display:flex;"><span>sleep <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>ps aux|grep redis
</span></span><span style="display:flex;"><span>IP<span style="color:#f92672">=</span><span style="color:#e6db74">`</span>/sbin/ip addr show eth0 |grep <span style="color:#e6db74">&#39;inet &#39;</span> | cut -f2 | awk <span style="color:#e6db74">&#39;{ print $2}&#39;</span>|awk -F <span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#e6db74">&#39;{ print $1}&#39;</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># create cluster with one slave</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;yes&#34;</span> | ruby /usr/local/redis/bin/redis-trib.rb create --replicas <span style="color:#ae81ff">1</span> <span style="color:#e6db74">${</span>IP<span style="color:#e6db74">}</span>:7001 <span style="color:#e6db74">${</span>IP<span style="color:#e6db74">}</span>:7002 <span style="color:#e6db74">${</span>IP<span style="color:#e6db74">}</span>:7003 <span style="color:#e6db74">${</span>IP<span style="color:#e6db74">}</span>:7004 <span style="color:#e6db74">${</span>IP<span style="color:#e6db74">}</span>:7005 <span style="color:#e6db74">${</span>IP<span style="color:#e6db74">}</span>:7006
</span></span><span style="display:flex;"><span>tail -f /var/log/supervisor/redis-1.log
</span></span></code></pre></div><h3 id="34-supervisord配置">3.4 supervisord配置</h3>
<p>config/supervisord.conf</p>
<pre tabindex="0"><code class="language-conf" data-lang="conf">[supervisord]
nodaemon=false

[program:redis-1]
command=/usr/local/redis/bin/redis-server /usr/local/redis/etc/redis-3.0.0_7001.conf
stdout_logfile=/var/log/supervisor/%(program_name)s.log
stderr_logfile=/var/log/supervisor/%(program_name)s.log
autorestart=true

[program:redis-2]
command=/usr/local/redis/bin/redis-server /usr/local/redis/etc/redis-3.0.0_7002.conf
stdout_logfile=/var/log/supervisor/%(program_name)s.log
stderr_logfile=/var/log/supervisor/%(program_name)s.log
autorestart=true

[program:redis-3]
command=/usr/local/redis/bin/redis-server /usr/local/redis/etc/redis-3.0.0_7003.conf
stdout_logfile=/var/log/supervisor/%(program_name)s.log
stderr_logfile=/var/log/supervisor/%(program_name)s.log
autorestart=true

[program:redis-4]
command=/usr/local/redis/bin/redis-server /usr/local/redis/etc/redis-3.0.0_7004.conf
stdout_logfile=/var/log/supervisor/%(program_name)s.log
stderr_logfile=/var/log/supervisor/%(program_name)s.log
autorestart=true

[program:redis-5]
command=/usr/local/redis/bin/redis-server /usr/local/redis/etc/redis-3.0.0_7005.conf
stdout_logfile=/var/log/supervisor/%(program_name)s.log
stderr_logfile=/var/log/supervisor/%(program_name)s.log
autorestart=true

[program:redis-6]
command=/usr/local/redis/bin/redis-server /usr/local/redis/etc/redis-3.0.0_7006.conf
stdout_logfile=/var/log/supervisor/%(program_name)s.log
stderr_logfile=/var/log/supervisor/%(program_name)s.log
autorestart=true
</code></pre>
    </section>
    <section class="post-toc">
      <span>CONTENTS</span>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#一mysql">一、MySql</a>
      <ul>
        <li><a href="#11-获取镜像运行">1.1 获取镜像运行</a></li>
        <li><a href="#12-mysql数据持久化">1.2 mysql数据持久化</a></li>
      </ul>
    </li>
    <li><a href="#rabbitmq">RabbitMQ</a></li>
    <li><a href="#三dockerfile构建redis伪集群">三、Dockerfile构建redis伪集群</a>
      <ul>
        <li><a href="#31-编写dockerfie">3,1 编写Dockerfie</a></li>
        <li><a href="#32-redis配置文件">3.2 redis配置文件</a></li>
        <li><a href="#33-启动脚本">3.3 启动脚本</a></li>
        <li><a href="#34-supervisord配置">3.4 supervisord配置</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </section>


  <footer class="post-footer">

    








<figure class="author-image">
    <a class="img" href="http://thoreauz.com" style="background-image: url(/Dog-b.svg)"><span class="hidden">二道涯's Picture</span></a>
</figure>


<section class="author">
  <h4><a href="http://thoreauz.com">二道涯</a></h4>
  
  <p>Read <a href="http://thoreauz.com">more posts</a> by this author.</p>
  
  <div class="author-meta">
    <span class="author-location icon-location">Hangzhou, China</span>
    <span class="author-link icon-link"><a href="http://thoreauz.com">http://thoreauz.com</a></span>
  </div>
</section>




    
<section class="share">
    <h4>Share this post</h4>
    <a class="icon-twitter" style="font-size: 1.4em"
       href="https://twitter.com/share?text=Docker%e9%83%a8%e7%bd%b2MySql%e7%ad%89%e5%b8%b8%e7%94%a8%e8%bd%af%e4%bb%b6&nbsp;-&nbsp;%e9%80%a0%e8%88%9f%e9%87%8e%e6%b8%a1&amp;url=http%3a%2f%2fthoreauz.com%2f2017%2f02%2f10%2fdocker-deploy-mysql%2f"
       onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
        <span class="hidden">Twitter</span>
    </a>
    <a class="icon-facebook" style="font-size: 1.4em"
       href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fthoreauz.com%2f2017%2f02%2f10%2fdocker-deploy-mysql%2f"
       onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
        <span class="hidden">Facebook</span>
    </a>
    <a class="icon-pinterest" style="font-size: 1.4em"
       href="http://pinterest.com/pin/create/button/?url=http%3a%2f%2fthoreauz.com%2f2017%2f02%2f10%2fdocker-deploy-mysql%2f&amp;description=Docker%e9%83%a8%e7%bd%b2MySql%e7%ad%89%e5%b8%b8%e7%94%a8%e8%bd%af%e4%bb%b6"
       onclick="window.open(this.href, 'pinterest-share','width=580,height=296');return false;">
        <span class="hidden">Pinterest</span>
    </a>
    <a class="icon-google-plus" style="font-size: 1.4em" href="https://plus.google.com/share?url=http%3a%2f%2fthoreauz.com%2f2017%2f02%2f10%2fdocker-deploy-mysql%2f"
       onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
        <span class="hidden">Google+</span>
    </a>
</section>



    
     
        
<div id="gitalk-container"></div>

<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>
<script type="text/javascript">
  var gitalk = new Gitalk({
    clientID: "2b2dad16b1a3987d6f94",
    clientSecret: "1c9113ee087febd62068f33f47c190fc4e38bf48",
    repo: "gitment-comments",
    owner: "ThoreauZZ",
    admin: ["ThoreauZZ"],
    
    id: md5(location.pathname),
    distractionFreeMode: "true"
  });
  gitalk.render("gitalk-container");
</script>

 
    



  </footer>
</article>

</main>


  <aside class="read-next">
  
      <a class="read-next-story" style="no-cover" href="http://thoreauz.com/2017/02/12/git-rm-bigfile/">
          <section class="post">
              <h2>git删除版本库中大文件记录</h2>
              
          </section>
      </a>
  
  
      <a class="read-next-story prev" style="no-cover" href="http://thoreauz.com/2017/02/09/ELK%E6%97%A5%E5%BF%97%E6%90%9C%E9%9B%86%E6%9F%A5%E8%AF%A2/">
          <section class="post">
              <h2>ELK日志搜集查询</h2>
          </section>
      </a>
  
</aside>


    <footer class="site-footer clearfix">
        
        <div class="bsz-counter">
            <span id="busuanzi_container_site_uv">本站访客数<span id="busuanzi_value_site_uv"></span>人次;</span>
            <span id="busuanzi_container_page_pv">本文总阅读量<span id="busuanzi_value_page_pv"></span>次</span>
        </div>
        

        <section class="copyright"><a href="">造舟野渡</a> All rights reserved - 2017</section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
        

    </footer>

    </div>
    <script type="text/javascript" src="http://thoreauz.com/js/jquery.js"></script>
    <script type="text/javascript" src="http://thoreauz.com/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="http://thoreauz.com/js/index.js"></script>
    
</body>
</html>

